#! /usr/bin/python
# by pts@fazekas.hu at Sat Apr 25 19:20:59 CEST 2020

import binascii
import sys
import unittest

import rsakeytool

# six-like compatibility layer between Python 2.x and Python 3.x.
from rsakeytool import bb

DROPBEAR_DATA = binascii.unhexlify(bb('000000077373682d727361000000030100010000020100c7e5c2aaa8e9e8be55a16277ab0c60d5249c0996578ae1e63261664c3b08e42ce69af7817255d0c2b3cc640b311e7d76cf1a346839905195045a040c819bd2227300130a1a7ebe78609d69c0170a1362acd57e2a605b035ae9a4904d322621079b1484640269b7a115997ced3a1fb06e7e298ad57746a7395d9b09893e7d63c48f802132cd9c530a80af0d253705dfb1212adae3a29642aeeb18c52103ec8b5a731e65af07a6b1667e385f9208c7e41ef22085f9af955b373ecc96b04b20b24a9f835ec1787b4e5471a459b7ac23a3e8e1ee8c915081a1ee4a55a13c2b077f6c58aa7db1e4badcf670c24ff14c179146e573eb99db77bdf3a83bce808185b194953d5ccc78be03ec7665c6bab34a7fe45bfb306efa8d1e5e9dc2403ef66a1da2cae70b7026c5223782ae28252eac0103715e2e4341b9040d46f886bd198ccd832fddc3b977fa73015535927ed7813f62453722a3e64e3cec779bda447cd2455da608ea227cd35dfc69db9bced50d9c3d826bc8db25d7657a6268084dd8c267e36cc7882df00ae583deab706c558a60509dbfeb4a098c4df466c44bd86e7d28e53480f2c855b7b6688ebd1e1d1c4ae0e61718f114c88e274833dbdb058721d37aa43ff1e0d33dd14fc4463d86f0fe7f32fb438204536f67f25cfc7d85d6eb58e5122533ee69c7eda10f95b1a5217a23c25ef57292b571d60919ee20737cafff0900000201008b682fe7a6df6222834386916067c48c40f8d532d52095445df4514c6e8b57ddfc812c85494091d38762ce8e8395f8f7c79d45d93df3e9015cc48e384e9765e8027d95c9a10aad38f4603364f46c61729a885571a63b32cecf4ca61a4014194add9b646cfec5cd7b78bdcf42fe1b258719534d706bbb8959d76f0d2a7abb25bdea39f86d1eb99bac226c726576c710e6cdf3be2dacb0d0167efc8a55e90fa96bce06eff12e0bd182621a5c8452bd5cd93c10f47e5a367623c417182c2068d00e7cca386602e9338a6eaaa8ab1050d6b9cdfef8674b56eca06b94e65a38c404d881c97cd97863dd3fbd09b688d881431ec75c9d7d727242b5cfa8cdee0ee6371de50d4c4285c090baeebe8751242a6b9ee9fda9fa5a6fd93db08e52fcb92226bbd589ab5f31b01669e0c812fbae47fc1812f1619502a3cf8b3e592394f3b466293e9d355d17fef3b39afc137460f1e60746f62260a2fe2f419385e9a762cb18ad9a79d497ac9476d8c0a9fac34ea90729749ff6e0efbfe9f2976d1c6274a5e694118dfd1eb941f76f125ca85e1983bb8733dde8cca23f16fc0047f1a4b4959788764e1efdd2b292a8f54c6f11eea8bef5a262b75b9282f5528da9a7a7bf2d69cabee340238ad11d0f49333422fbded7df44d83b5a9c4d34e9b2113a7bf6a169a490afbcb48b12db4bf4920db53c376b7d7bcbd9a9859eeaaa31672bd38fb2f8250000010100f0710459cd01a206f4c4dbb8cd591c3f240c887c11bfef21d00cb0b973e4adafb373c1fec279252771e78f0cde980723f97c5457e72648e2eafaea98414eb8448be103e0e276c0a772735e9eacb45e2ac8d03562ea2c72fb1b83c101e6355aae764dff1fcd7f18ea3c8c384052e64cff91a23085d1149d9ed6c7e3bfa1e09735d6ebfeb981ed168c4942f384570c54b07c01e61afc9277a959147715ec17a29fc0a41e4c694813f755ba4f5ba21f221c0ac7d44e499e0856c66c1330b4d32f09e7b4f3bb47f6a564d381872e0d2b1b3c3dc132d31500e7fa7bde2c302a217bedba964d2dbc02d84b47cbe8bafac184963e65b028d9f6fa71b975440d0513aea30000010100d4d51ee89043051536d581b984820ba0925c006b327490ac010b27780b4612873d7c1ed1accd4e994518a51252de889410c8fefdb7fbfe05352506897a8e507eda7063ff33adda4020be19a32b26d13f35c0aa92d67cdca855561feb0e8d929481e29ce65906acc37eb514ac9b4743d8b6605ff6caa4abb1372c5b6d3c15639fc441cf5780f5dce59dc71c04e41b396bb84162b6d26f33b83ab6f63635f637d0dc36d263ba78c1bd0ba80726cda6ec09e90cd4933948ec17d43762f54c3fa8d33ed90b62204f35ba8b9354addbf227437ff5fe7f6602a3377f48a5e4db2fadd97b02ffe394a9cf2ffef2bbb1c0fa7b495306a4191aa9f4c5fea6dc9ec5c41263'))

OPENSSHSINGLE_DATA = binascii.unhexlify(bb('000000077373682d7273610000020100c7e5c2aaa8e9e8be55a16277ab0c60d5249c0996578ae1e63261664c3b08e42ce69af7817255d0c2b3cc640b311e7d76cf1a346839905195045a040c819bd2227300130a1a7ebe78609d69c0170a1362acd57e2a605b035ae9a4904d322621079b1484640269b7a115997ced3a1fb06e7e298ad57746a7395d9b09893e7d63c48f802132cd9c530a80af0d253705dfb1212adae3a29642aeeb18c52103ec8b5a731e65af07a6b1667e385f9208c7e41ef22085f9af955b373ecc96b04b20b24a9f835ec1787b4e5471a459b7ac23a3e8e1ee8c915081a1ee4a55a13c2b077f6c58aa7db1e4badcf670c24ff14c179146e573eb99db77bdf3a83bce808185b194953d5ccc78be03ec7665c6bab34a7fe45bfb306efa8d1e5e9dc2403ef66a1da2cae70b7026c5223782ae28252eac0103715e2e4341b9040d46f886bd198ccd832fddc3b977fa73015535927ed7813f62453722a3e64e3cec779bda447cd2455da608ea227cd35dfc69db9bced50d9c3d826bc8db25d7657a6268084dd8c267e36cc7882df00ae583deab706c558a60509dbfeb4a098c4df466c44bd86e7d28e53480f2c855b7b6688ebd1e1d1c4ae0e61718f114c88e274833dbdb058721d37aa43ff1e0d33dd14fc4463d86f0fe7f32fb438204536f67f25cfc7d85d6eb58e5122533ee69c7eda10f95b1a5217a23c25ef57292b571d60919ee20737cafff090000000301000100000201008b682fe7a6df6222834386916067c48c40f8d532d52095445df4514c6e8b57ddfc812c85494091d38762ce8e8395f8f7c79d45d93df3e9015cc48e384e9765e8027d95c9a10aad38f4603364f46c61729a885571a63b32cecf4ca61a4014194add9b646cfec5cd7b78bdcf42fe1b258719534d706bbb8959d76f0d2a7abb25bdea39f86d1eb99bac226c726576c710e6cdf3be2dacb0d0167efc8a55e90fa96bce06eff12e0bd182621a5c8452bd5cd93c10f47e5a367623c417182c2068d00e7cca386602e9338a6eaaa8ab1050d6b9cdfef8674b56eca06b94e65a38c404d881c97cd97863dd3fbd09b688d881431ec75c9d7d727242b5cfa8cdee0ee6371de50d4c4285c090baeebe8751242a6b9ee9fda9fa5a6fd93db08e52fcb92226bbd589ab5f31b01669e0c812fbae47fc1812f1619502a3cf8b3e592394f3b466293e9d355d17fef3b39afc137460f1e60746f62260a2fe2f419385e9a762cb18ad9a79d497ac9476d8c0a9fac34ea90729749ff6e0efbfe9f2976d1c6274a5e694118dfd1eb941f76f125ca85e1983bb8733dde8cca23f16fc0047f1a4b4959788764e1efdd2b292a8f54c6f11eea8bef5a262b75b9282f5528da9a7a7bf2d69cabee340238ad11d0f49333422fbded7df44d83b5a9c4d34e9b2113a7bf6a169a490afbcb48b12db4bf4920db53c376b7d7bcbd9a9859eeaaa31672bd38fb2f82500000100396271522fa813889c95111768c398ba21768328c008f9fca9868502ab1fa1bfc7c73f8ece306ec4a449a91862047d6a6bf55bdb7175e8ae5337180be4cd0ebcc6ee8ffd225b5d0a83da0f3a0256eed6232cfde243543a6601352c53c6d2028db854870169d912d7c3914aa0698fa7fadf60b713847de69e090325502a5a417c75b272d0aeb81eb19d31980a08850a30bd04d1a33093fee0fcc2a3b76e62c0834fa4633437f0a77143eba92b76590223e5f6de7488c171381593848c6b6a0d5b8a95f09c0aee821fa2bc057ba8f2751f3e9d105937c60782d1e8e7933cddf1876e697d44c93fc1e1006568e66d0d79b2cb4882d4dd618991a5a3a7b1b2c1362a0000010100f0710459cd01a206f4c4dbb8cd591c3f240c887c11bfef21d00cb0b973e4adafb373c1fec279252771e78f0cde980723f97c5457e72648e2eafaea98414eb8448be103e0e276c0a772735e9eacb45e2ac8d03562ea2c72fb1b83c101e6355aae764dff1fcd7f18ea3c8c384052e64cff91a23085d1149d9ed6c7e3bfa1e09735d6ebfeb981ed168c4942f384570c54b07c01e61afc9277a959147715ec17a29fc0a41e4c694813f755ba4f5ba21f221c0ac7d44e499e0856c66c1330b4d32f09e7b4f3bb47f6a564d381872e0d2b1b3c3dc132d31500e7fa7bde2c302a217bedba964d2dbc02d84b47cbe8bafac184963e65b028d9f6fa71b975440d0513aea30000010100d4d51ee89043051536d581b984820ba0925c006b327490ac010b27780b4612873d7c1ed1accd4e994518a51252de889410c8fefdb7fbfe05352506897a8e507eda7063ff33adda4020be19a32b26d13f35c0aa92d67cdca855561feb0e8d929481e29ce65906acc37eb514ac9b4743d8b6605ff6caa4abb1372c5b6d3c15639fc441cf5780f5dce59dc71c04e41b396bb84162b6d26f33b83ab6f63635f637d0dc36d263ba78c1bd0ba80726cda6ec09e90cd4933948ec17d43762f54c3fa8d33ed90b62204f35ba8b9354addbf227437ff5fe7f6602a3377f48a5e4db2fadd97b02ffe394a9cf2ffef2bbb1c0fa7b495306a4191aa9f4c5fea6dc9ec5c41263000000000102'))

OPENSSHLD_DATA = binascii.unhexlify(bb('0000073843484b4943484b49')) + OPENSSHSINGLE_DATA

OPENSSHBIN_DATA = binascii.unhexlify(bb('6f70656e7373682d6b65792d763100000000046e6f6e65000000046e6f6e65000000000000000100000217000000077373682d727361000000030100010000020100c7e5c2aaa8e9e8be55a16277ab0c60d5249c0996578ae1e63261664c3b08e42ce69af7817255d0c2b3cc640b311e7d76cf1a346839905195045a040c819bd2227300130a1a7ebe78609d69c0170a1362acd57e2a605b035ae9a4904d322621079b1484640269b7a115997ced3a1fb06e7e298ad57746a7395d9b09893e7d63c48f802132cd9c530a80af0d253705dfb1212adae3a29642aeeb18c52103ec8b5a731e65af07a6b1667e385f9208c7e41ef22085f9af955b373ecc96b04b20b24a9f835ec1787b4e5471a459b7ac23a3e8e1ee8c915081a1ee4a55a13c2b077f6c58aa7db1e4badcf670c24ff14c179146e573eb99db77bdf3a83bce808185b194953d5ccc78be03ec7665c6bab34a7fe45bfb306efa8d1e5e9dc2403ef66a1da2cae70b7026c5223782ae28252eac0103715e2e4341b9040d46f886bd198ccd832fddc3b977fa73015535927ed7813f62453722a3e64e3cec779bda447cd2455da608ea227cd35dfc69db9bced50d9c3d826bc8db25d7657a6268084dd8c267e36cc7882df00ae583deab706c558a60509dbfeb4a098c4df466c44bd86e7d28e53480f2c855b7b6688ebd1e1d1c4ae0e61718f114c88e274833dbdb058721d37aa43ff1e0d33dd14fc4463d86f0fe7f32fb438204536f67f25cfc7d85d6eb58e5122533ee69c7eda10f95b1a5217a23c25ef57292b571d60919ee20737cafff09')) + OPENSSHLD_DATA

OPENSSH_DATA = bb('''-----BEGIN OPENSSH PRIVATE KEY-----
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
xf6m3J7FxBJjAAAAAAEC
-----END OPENSSH PRIVATE KEY-----
''')

MSBLOB_DATA = binascii.unhexlify(bb('0702000000a4000052534132001000000100010009ffaf7c7320ee1909d671b59272f55ec2237a21a5b1950fa1edc769ee332512e558ebd6857dfc5cf2676f53048243fb327ffef0863d46c44fd13dd3e0f13fa47ad3218705dbdb3348278ec814f11817e6e04a1c1d1ebd8e68b6b755c8f28034e5287d6ed84bc466f44d8c094aebbf9d50608a556c70abde83e50af02d88c76ce367c2d84d0868627a65d725dbc86b823d9c0dd5ce9bdb69fc5dd37c22ea08a65d45d27c44da9b77ec3c4ee6a3223745623f81d77e9235550173fa77b9c3dd2f83cd8c19bd86f8460d04b941432e5e710301ac2e2528ae823722c526700be7caa21d6af63e40c29d5e1e8dfa6e30fb5be47f4ab3bac66576ec03be78cc5c3d9594b1858180ce3ba8f3bd77db99eb73e54691174cf14fc270f6dcbae4b17daa586c7f072b3ca1554aeea18150918ceee1e8a323acb759a471544e7b78c15e839f4ab2204bb096cc3e375b95aff98520f21ee4c708925f387e66b1a607af651e735a8bec0321c518ebae4296a2e3da2a21b1df0537250daf800a539ccd3221808fc4637d3e89099b5d39a74677d58a297e6eb01f3aed7c9915a1b769026484149b072126324d90a4e95a035b602a7ed5ac62130a17c0699d6078be7e1a0a13007322d29b810c045a049551903968341acf767d1e310b64ccb3c2d0557281f79ae62ce4083b4c666132e6e18a5796099c24d5600cab7762a155bee8e9a8aac2e5c7a3ae13050d4475b971faf6d928b0653e9684c1fabae8cb474bd802bc2d4d96baed7b212a302cde7bfae70015d332c13d3c1b2b0d2e8781d364a5f647bbf3b4e7092fd3b430136cc656089e494ed4c70a1c221fa25b4fba55f71348694c1ea4c09fa217ec15771459a97792fc1ae6017cb0540c5784f342498c16ed81b9feebd63597e0a1bfe3c7d69e9d14d18530a291ff4ce65240388c3cea187fcd1fff4d76ae5a35e601c1831bfb722cea6235d0c82a5eb4ac9e5e7372a7c076e2e003e18b44b84e4198eafaeae24826e757547cf9230798de0c8fe771272579c2fec173b3afade473b9b00cd021efbf117c880c243f1c59cdb8dbc4f406a201cd590471f06312c4c59edca6fec5f4a91a19a40653497bfac0b1bbf2fe2fcfa994e3ff027bd9ad2fdbe4a5487f37a302667ffef57f4327f2dbad54938bba354f20620bd93ed3a83f4cf56237d417ec483993d40ce909eca6cd2607a80bbdc178ba63d236dcd037f63536f6b63ab8336fd2b66241b86b391be4041cc79de5dcf58057cf41c49f63153c6d5b2c37b1aba4caf65f60b6d843479bac14b57ec3ac0659e69ce28194928d0eeb1f5655a8dc7cd692aac0353fd1262ba319be2040daad33ff6370da7e508e7a8906253505fefbb7fdfec8109488de5212a51845994ecdacd11e7c3d8712460b78270b01ac9074326b005c92a00b8284b981d53615054390e81ed5d40b402760e89292d6f87fb024a94d5975f7007beed3554615d63cc74f40f7523024744520f59a3f9b5335d5963bd02eacdbf3cc7e205ca4a3b40133d62286e1f454b57921574b4008d0c23c74a5b31ff00cc9a31eb431cebdfc7c5265a12a01c7257e3a946fa4f78bea2f334962c8d14ef700327a54c4895c9aa1af9c84620f778f6b29b1d45058923b36abda3998837125a7f39c942acf2d7d720c46704804d998c29f1f9a80d5e4f2958429eadfeb728ff27870d3839907f7a573d4dd22d2031b322edfb0a64da1ce51a2b21a142b24d9fd31ff6032be8333184b49ae1aa93be5949c687fedf5ee00c106588f2c060bb8ad2faa312ed7bfe1d24e3a946706359b56905c4b009ea8a78da0c9f50842db4117b2d43a4d3b5db1be41d8374b515a03125b3e61d2b03fdf8876ceed9ab4038c9384971bb918228d9bdaa681b460ae6d624d4664f85a0f024c4d7a8a58800ef0827ee09d17e75bf175250245ecf6bc019d953b5a93dabba0266c605565ed56506800b3b5dbbfcae51f594ba8159637662c520e15c87e5537b91afa196894b7d7d28abeadb5a8627b73f6a203639d8180f7b62b413d8e2519e192c3149ddd1cbd2420e9a241e41654627870df7f9683ba6b1e50edeb33e408ec8bf7990e6dca86d5bc7e38e202b4c563893b2cefe743a03cd76f40c87e857faf3455c6f3d9f5a8da3c8719520d6fd23a7fc5258fce672a36c1b2b1a7a3a5918961ddd48248cbb2790d6de6686500e1c13fc9447d696e87f1dd3c93e7e8d18207c63759109d3e1f75f2a87b05bca21f82ee0a9cf0958a5b0d6a6b8c8493153871c18874def6e5230259762ba9eb4371a7f0373463a44f83c0626eb7a3c2fce0fe9330a3d104bd300a85080a98319db11eb8aed072b2757c415a2a502503099ee67d8413b760dffaa78f69a04a91c3d712d969018754b88d02d2c6532c3501663a5443e2fd2c23d6ee56023a0fda830a5d5b22fd8feec6bc0ecde40b183753aee87571db5bf56b6a7d046218a949a4c46e30ce8e3fc7c7bfa11fab028586a9fcf908c028837621ba98c3681711959c8813a82f5271623925f8b28fd32b6731aaea9e85a9d9cb7b7d6b373cb50d92f44bdb128bb4bcaf90a469a1f67b3a11b2e9344d9c5a3bd844dfd7defb223433490f1dd18a2340e3beca692dbfa7a7a98d52f582925bb762a2f5bea8ee116f4cf5a892b2d2fd1e4e76889795b4a4f14700fc163fa2cce8dd3387bb83195ea85c126ff741b91efd8d1194e6a574621c6d97f2e9bfefe0f69f742907a94ec3faa9c0d87694ac97d4799aad18cb62a7e98593412ffea26022f64607e6f1607413fc9ab3f3fe175d359d3e2966b4f39423593e8bcfa3029561f11218fc47aefb12c8e06916b0315fab89d5bb2622b9fc528eb03dd96f5afaa9fde99e6b2a245187beeeba90c085424c0de51d37e60eeecda8cfb54272727d9d5cc71e4381d888b609bd3fdd6378d97cc981d804c4385ae6946ba0ec564b67f8fecdb9d65010aba8aa6e8a33e9026638ca7c0ed068202c1817c42376365a7ef4103cd95cbd52845c1a6282d10b2ef1ef06ce6ba90fe9558afc7e16d0b0ac2dbef3cde610c77665726c22ac9bb91e6df839eabd25bb7a2a0d6fd75989bb6b704d531987251bfe42cfbd787bcdc5fe6c649bdd4a1914401aa64ccfce323ba67155889a72616cf4643360f438ad0aa1c9957d02e865974e388ec45c01e9f33dd9459dc7f7f895838ece6287d3914049852c81fcdd578b6e4c51f45d449520d532d5f8408cc46760918643832262dfa6e72f688b'))

GPG22_DATA = binascii.unhexlify(bb('2831313a707269766174652d6b657928333a72736128313a6e3531333a00c7e5c2aaa8e9e8be55a16277ab0c60d5249c0996578ae1e63261664c3b08e42ce69af7817255d0c2b3cc640b311e7d76cf1a346839905195045a040c819bd2227300130a1a7ebe78609d69c0170a1362acd57e2a605b035ae9a4904d322621079b1484640269b7a115997ced3a1fb06e7e298ad57746a7395d9b09893e7d63c48f802132cd9c530a80af0d253705dfb1212adae3a29642aeeb18c52103ec8b5a731e65af07a6b1667e385f9208c7e41ef22085f9af955b373ecc96b04b20b24a9f835ec1787b4e5471a459b7ac23a3e8e1ee8c915081a1ee4a55a13c2b077f6c58aa7db1e4badcf670c24ff14c179146e573eb99db77bdf3a83bce808185b194953d5ccc78be03ec7665c6bab34a7fe45bfb306efa8d1e5e9dc2403ef66a1da2cae70b7026c5223782ae28252eac0103715e2e4341b9040d46f886bd198ccd832fddc3b977fa73015535927ed7813f62453722a3e64e3cec779bda447cd2455da608ea227cd35dfc69db9bced50d9c3d826bc8db25d7657a6268084dd8c267e36cc7882df00ae583deab706c558a60509dbfeb4a098c4df466c44bd86e7d28e53480f2c855b7b6688ebd1e1d1c4ae0e61718f114c88e274833dbdb058721d37aa43ff1e0d33dd14fc4463d86f0fe7f32fb438204536f67f25cfc7d85d6eb58e5122533ee69c7eda10f95b1a5217a23c25ef57292b571d60919ee20737cafff092928313a65333a0100012928313a643531333a008b682fe7a6df6222834386916067c48c40f8d532d52095445df4514c6e8b57ddfc812c85494091d38762ce8e8395f8f7c79d45d93df3e9015cc48e384e9765e8027d95c9a10aad38f4603364f46c61729a885571a63b32cecf4ca61a4014194add9b646cfec5cd7b78bdcf42fe1b258719534d706bbb8959d76f0d2a7abb25bdea39f86d1eb99bac226c726576c710e6cdf3be2dacb0d0167efc8a55e90fa96bce06eff12e0bd182621a5c8452bd5cd93c10f47e5a367623c417182c2068d00e7cca386602e9338a6eaaa8ab1050d6b9cdfef8674b56eca06b94e65a38c404d881c97cd97863dd3fbd09b688d881431ec75c9d7d727242b5cfa8cdee0ee6371de50d4c4285c090baeebe8751242a6b9ee9fda9fa5a6fd93db08e52fcb92226bbd589ab5f31b01669e0c812fbae47fc1812f1619502a3cf8b3e592394f3b466293e9d355d17fef3b39afc137460f1e60746f62260a2fe2f419385e9a762cb18ad9a79d497ac9476d8c0a9fac34ea90729749ff6e0efbfe9f2976d1c6274a5e694118dfd1eb941f76f125ca85e1983bb8733dde8cca23f16fc0047f1a4b4959788764e1efdd2b292a8f54c6f11eea8bef5a262b75b9282f5528da9a7a7bf2d69cabee340238ad11d0f49333422fbded7df44d83b5a9c4d34e9b2113a7bf6a169a490afbcb48b12db4bf4920db53c376b7d7bcbd9a9859eeaaa31672bd38fb2f8252928313a703235373a00d4d51ee89043051536d581b984820ba0925c006b327490ac010b27780b4612873d7c1ed1accd4e994518a51252de889410c8fefdb7fbfe05352506897a8e507eda7063ff33adda4020be19a32b26d13f35c0aa92d67cdca855561feb0e8d929481e29ce65906acc37eb514ac9b4743d8b6605ff6caa4abb1372c5b6d3c15639fc441cf5780f5dce59dc71c04e41b396bb84162b6d26f33b83ab6f63635f637d0dc36d263ba78c1bd0ba80726cda6ec09e90cd4933948ec17d43762f54c3fa8d33ed90b62204f35ba8b9354addbf227437ff5fe7f6602a3377f48a5e4db2fadd97b02ffe394a9cf2ffef2bbb1c0fa7b495306a4191aa9f4c5fea6dc9ec5c412632928313a713235373a00f0710459cd01a206f4c4dbb8cd591c3f240c887c11bfef21d00cb0b973e4adafb373c1fec279252771e78f0cde980723f97c5457e72648e2eafaea98414eb8448be103e0e276c0a772735e9eacb45e2ac8d03562ea2c72fb1b83c101e6355aae764dff1fcd7f18ea3c8c384052e64cff91a23085d1149d9ed6c7e3bfa1e09735d6ebfeb981ed168c4942f384570c54b07c01e61afc9277a959147715ec17a29fc0a41e4c694813f755ba4f5ba21f221c0ac7d44e499e0856c66c1330b4d32f09e7b4f3bb47f6a564d381872e0d2b1b3c3dc132d31500e7fa7bde2c302a217bedba964d2dbc02d84b47cbe8bafac184963e65b028d9f6fa71b975440d0513aea32928313a753235363a396271522fa813889c95111768c398ba21768328c008f9fca9868502ab1fa1bfc7c73f8ece306ec4a449a91862047d6a6bf55bdb7175e8ae5337180be4cd0ebcc6ee8ffd225b5d0a83da0f3a0256eed6232cfde243543a6601352c53c6d2028db854870169d912d7c3914aa0698fa7fadf60b713847de69e090325502a5a417c75b272d0aeb81eb19d31980a08850a30bd04d1a33093fee0fcc2a3b76e62c0834fa4633437f0a77143eba92b76590223e5f6de7488c171381593848c6b6a0d5b8a95f09c0aee821fa2bc057ba8f2751f3e9d105937c60782d1e8e7933cddf1876e697d44c93fc1e1006568e66d0d79b2cb4882d4dd618991a5a3a7b1b2c1362a292929'))

GPG23_DATA = bb('''Key: (private-key
  (rsa
  (n #00C7E5C2AAA8E9E8BE55A16277AB0C60D5249C0996578AE1E63261664C3B08E42CE69AF7817255D0C2B3CC640B311E7D76CF1A346839905195045A040C819BD2227300130A1A7EBE78609D69C0170A1362ACD57E2A605B035AE9A4904D322621079B1484640269B7A115997CED3A1FB06E7E298AD57746A7395D9B09893E7D63C48F802132CD9C530A80AF0D253705DFB1212ADAE3A29642AEEB18C52103EC8B5A731E65AF07A6B1667E385F9208C7E41EF22085F9AF955B373ECC96B04B20B24A9F835EC1787B4E5471A459B7AC23A3E8E1EE8C915081A1EE4A55A13C2B077F6C58AA7DB1E4BADCF670C24FF14C179146E573EB99DB77BDF3A83BCE808185B194953D5CCC78BE03EC7665C6BAB34A7FE45BFB306EFA8D1E5E9DC2403EF66A1DA2CAE70B7026C5223782AE28252EAC0103715E2E4341B9040D46F886BD198CCD832FDDC3B977FA73015535927ED7813F62453722A3E64E3CEC779BDA447CD2455DA608EA227CD35DFC69DB9BCED50D9C3D826BC8DB25D7657A6268084DD8C267E36CC7882DF00AE583DEAB706C558A60509DBFEB4A098C4DF466C44BD86E7D28E53480F2C855B7B6688EBD1E1D1C4AE0E61718F114C88E274833DBDB058721D37AA43FF1E0D33DD14FC4463D86F0FE7F32FB438204536F67F25CFC7D85D6EB58E5122533EE69C7EDA10F95B1A5217A23C25EF57292B571D60919EE20737CAFFF09#)
  (e #010001#)
  (d #008B682FE7A6DF6222834386916067C48C40F8D532D52095445DF4514C6E8B57DDFC812C85494091D38762CE8E8395F8F7C79D45D93DF3E9015CC48E384E9765E8027D95C9A10AAD38F4603364F46C61729A885571A63B32CECF4CA61A4014194ADD9B646CFEC5CD7B78BDCF42FE1B258719534D706BBB8959D76F0D2A7ABB25BDEA39F86D1EB99BAC226C726576C710E6CDF3BE2DACB0D0167EFC8A55E90FA96BCE06EFF12E0BD182621A5C8452BD5CD93C10F47E5A367623C417182C2068D00E7CCA386602E9338A6EAAA8AB1050D6B9CDFEF8674B56ECA06B94E65A38C404D881C97CD97863DD3FBD09B688D881431EC75C9D7D727242B5CFA8CDEE0EE6371DE50D4C4285C090BAEEBE8751242A6B9EE9FDA9FA5A6FD93DB08E52FCB92226BBD589AB5F31B01669E0C812FBAE47FC1812F1619502A3CF8B3E592394F3B466293E9D355D17FEF3B39AFC137460F1E60746F62260A2FE2F419385E9A762CB18AD9A79D497AC9476D8C0A9FAC34EA90729749FF6E0EFBFE9F2976D1C6274A5E694118DFD1EB941F76F125CA85E1983BB8733DDE8CCA23F16FC0047F1A4B4959788764E1EFDD2B292A8F54C6F11EEA8BEF5A262B75B9282F5528DA9A7A7BF2D69CABEE340238AD11D0F49333422FBDED7DF44D83B5A9C4D34E9B2113A7BF6A169A490AFBCB48B12DB4BF4920DB53C376B7D7BCBD9A9859EEAAA31672BD38FB2F825#)
  (p #00D4D51EE89043051536D581B984820BA0925C006B327490AC010B27780B4612873D7C1ED1ACCD4E994518A51252DE889410C8FEFDB7FBFE05352506897A8E507EDA7063FF33ADDA4020BE19A32B26D13F35C0AA92D67CDCA855561FEB0E8D929481E29CE65906ACC37EB514AC9B4743D8B6605FF6CAA4ABB1372C5B6D3C15639FC441CF5780F5DCE59DC71C04E41B396BB84162B6D26F33B83AB6F63635F637D0DC36D263BA78C1BD0BA80726CDA6EC09E90CD4933948EC17D43762F54C3FA8D33ED90B62204F35BA8B9354ADDBF227437FF5FE7F6602A3377F48A5E4DB2FADD97B02FFE394A9CF2FFEF2BBB1C0FA7B495306A4191AA9F4C5FEA6DC9EC5C41263#)
  (q #00F0710459CD01A206F4C4DBB8CD591C3F240C887C11BFEF21D00CB0B973E4ADAFB373C1FEC279252771E78F0CDE980723F97C5457E72648E2EAFAEA98414EB8448BE103E0E276C0A772735E9EACB45E2AC8D03562EA2C72FB1B83C101E6355AAE764DFF1FCD7F18EA3C8C384052E64CFF91A23085D1149D9ED6C7E3BFA1E09735D6EBFEB981ED168C4942F384570C54B07C01E61AFC9277A959147715EC17A29FC0A41E4C694813F755BA4F5BA21F221C0AC7D44E499E0856C66C1330B4D32F09E7B4F3BB47F6A564D381872E0D2B1B3C3DC132D31500E7FA7BDE2C302A217BEDBA964D2DBC02D84B47CBE8BAFAC184963E65B028D9F6FA71B975440D0513AEA3#)
  (u #396271522FA813889C95111768C398BA21768328C008F9FCA9868502AB1FA1BFC7C73F8ECE306EC4A449A91862047D6A6BF55BDB7175E8AE5337180BE4CD0EBCC6EE8FFD225B5D0A83DA0F3A0256EED6232CFDE243543A6601352C53C6D2028DB854870169D912D7C3914AA0698FA7FADF60B713847DE69E090325502A5A417C75B272D0AEB81EB19D31980A08850A30BD04D1A33093FEE0FCC2A3B76E62C0834FA4633437F0A77143EBA92B76590223E5F6DE7488C171381593848C6B6A0D5B8A95F09C0AEE821FA2BC057BA8F2751F3E9D105937C60782D1E8E7933CDDF1876E697D44C93FC1E1006568E66D0D79B2CB4882D4DD618991A5A3A7B1B2C1362A#)
  ))
''')

GPGLIST_DATA = bb('''gpg: reading options from '/home/user/.gnupg/gpg.conf'
gpg: enabled debug flags: mpi
# off=0 ctb=95 tag=5 hlen=3 plen=1816
:secret key packet:
\tversion 4, algo 1, created 1111111111, expires 0
\tpkey[0]: C7E5C2AAA8E9E8BE55A16277AB0C60D5249C0996578AE1E63261664C3B08E42CE69AF7817255D0C2B3CC640B311E7D76CF1A346839905195045A040C819BD2227300130A1A7EBE78609D69C0170A1362ACD57E2A605B035AE9A4904D322621079B1484640269B7A115997CED3A1FB06E7E298AD57746A7395D9B09893E7D63C48F802132CD9C530A80AF0D253705DFB1212ADAE3A29642AEEB18C52103EC8B5A731E65AF07A6B1667E385F9208C7E41EF22085F9AF955B373ECC96B04B20B24A9F835EC1787B4E5471A459B7AC23A3E8E1EE8C915081A1EE4A55A13C2B077F6C58AA7DB1E4BADCF670C24FF14C179146E573EB99DB77BDF3A83BCE808185B194953D5CCC78BE03EC7665C6BAB34A7FE45BFB306EFA8D1E5E9DC2403EF66A1DA2CAE70B7026C5223782AE28252EAC0103715E2E4341B9040D46F886BD198CCD832FDDC3B977FA73015535927ED7813F62453722A3E64E3CEC779BDA447CD2455DA608EA227CD35DFC69DB9BCED50D9C3D826BC8DB25D7657A6268084DD8C267E36CC7882DF00AE583DEAB706C558A60509DBFEB4A098C4DF466C44BD86E7D28E53480F2C855B7B6688EBD1E1D1C4AE0E61718F114C88E274833DBDB058721D37AA43FF1E0D33DD14FC4463D86F0FE7F32FB438204536F67F25CFC7D85D6EB58E5122533EE69C7EDA10F95B1A5217A23C25EF57292B571D60919EE20737CAFFF09
\tpkey[1]: 010001
\tskey[2]: 8B682FE7A6DF6222834386916067C48C40F8D532D52095445DF4514C6E8B57DDFC812C85494091D38762CE8E8395F8F7C79D45D93DF3E9015CC48E384E9765E8027D95C9A10AAD38F4603364F46C61729A885571A63B32CECF4CA61A4014194ADD9B646CFEC5CD7B78BDCF42FE1B258719534D706BBB8959D76F0D2A7ABB25BDEA39F86D1EB99BAC226C726576C710E6CDF3BE2DACB0D0167EFC8A55E90FA96BCE06EFF12E0BD182621A5C8452BD5CD93C10F47E5A367623C417182C2068D00E7CCA386602E9338A6EAAA8AB1050D6B9CDFEF8674B56ECA06B94E65A38C404D881C97CD97863DD3FBD09B688D881431EC75C9D7D727242B5CFA8CDEE0EE6371DE50D4C4285C090BAEEBE8751242A6B9EE9FDA9FA5A6FD93DB08E52FCB92226BBD589AB5F31B01669E0C812FBAE47FC1812F1619502A3CF8B3E592394F3B466293E9D355D17FEF3B39AFC137460F1E60746F62260A2FE2F419385E9A762CB18AD9A79D497AC9476D8C0A9FAC34EA90729749FF6E0EFBFE9F2976D1C6274A5E694118DFD1EB941F76F125CA85E1983BB8733DDE8CCA23F16FC0047F1A4B4959788764E1EFDD2B292A8F54C6F11EEA8BEF5A262B75B9282F5528DA9A7A7BF2D69CABEE340238AD11D0F49333422FBDED7DF44D83B5A9C4D34E9B2113A7BF6A169A490AFBCB48B12DB4BF4920DB53C376B7D7BCBD9A9859EEAAA31672BD38FB2F825
\tskey[3]: D4D51EE89043051536D581B984820BA0925C006B327490AC010B27780B4612873D7C1ED1ACCD4E994518A51252DE889410C8FEFDB7FBFE05352506897A8E507EDA7063FF33ADDA4020BE19A32B26D13F35C0AA92D67CDCA855561FEB0E8D929481E29CE65906ACC37EB514AC9B4743D8B6605FF6CAA4ABB1372C5B6D3C15639FC441CF5780F5DCE59DC71C04E41B396BB84162B6D26F33B83AB6F63635F637D0DC36D263BA78C1BD0BA80726CDA6EC09E90CD4933948EC17D43762F54C3FA8D33ED90B62204F35BA8B9354ADDBF227437FF5FE7F6602A3377F48A5E4DB2FADD97B02FFE394A9CF2FFEF2BBB1C0FA7B495306A4191AA9F4C5FEA6DC9EC5C41263
\tskey[4]: F0710459CD01A206F4C4DBB8CD591C3F240C887C11BFEF21D00CB0B973E4ADAFB373C1FEC279252771E78F0CDE980723F97C5457E72648E2EAFAEA98414EB8448BE103E0E276C0A772735E9EACB45E2AC8D03562EA2C72FB1B83C101E6355AAE764DFF1FCD7F18EA3C8C384052E64CFF91A23085D1149D9ED6C7E3BFA1E09735D6EBFEB981ED168C4942F384570C54B07C01E61AFC9277A959147715EC17A29FC0A41E4C694813F755BA4F5BA21F221C0AC7D44E499E0856C66C1330B4D32F09E7B4F3BB47F6A564D381872E0D2B1B3C3DC132D31500E7FA7BDE2C302A217BEDBA964D2DBC02D84B47CBE8BAFAC184963E65B028D9F6FA71B975440D0513AEA3
\tskey[5]: 396271522FA813889C95111768C398BA21768328C008F9FCA9868502AB1FA1BFC7C73F8ECE306EC4A449A91862047D6A6BF55BDB7175E8AE5337180BE4CD0EBCC6EE8FFD225B5D0A83DA0F3A0256EED6232CFDE243543A6601352C53C6D2028DB854870169D912D7C3914AA0698FA7FADF60B713847DE69E090325502A5A417C75B272D0AEB81EB19D31980A08850A30BD04D1A33093FEE0FCC2A3B76E62C0834FA4633437F0A77143EBA92B76590223E5F6DE7488C171381593848C6B6A0D5B8A95F09C0AEE821FA2BC057BA8F2751F3E9D105937C60782D1E8E7933CDDF1876E697D44C93FC1E1006568E66D0D79B2CB4882D4DD618991A5A3A7B1B2C1362A
\tchecksum: 7c71
\tkeyid: 318562D809AD3F15
''')

DER2_DATA = binascii.unhexlify(bb('30820942020100300d06092a864886f70d01010105000482092c308209280201000282020100c7e5c2aaa8e9e8be55a16277ab0c60d5249c0996578ae1e63261664c3b08e42ce69af7817255d0c2b3cc640b311e7d76cf1a346839905195045a040c819bd2227300130a1a7ebe78609d69c0170a1362acd57e2a605b035ae9a4904d322621079b1484640269b7a115997ced3a1fb06e7e298ad57746a7395d9b09893e7d63c48f802132cd9c530a80af0d253705dfb1212adae3a29642aeeb18c52103ec8b5a731e65af07a6b1667e385f9208c7e41ef22085f9af955b373ecc96b04b20b24a9f835ec1787b4e5471a459b7ac23a3e8e1ee8c915081a1ee4a55a13c2b077f6c58aa7db1e4badcf670c24ff14c179146e573eb99db77bdf3a83bce808185b194953d5ccc78be03ec7665c6bab34a7fe45bfb306efa8d1e5e9dc2403ef66a1da2cae70b7026c5223782ae28252eac0103715e2e4341b9040d46f886bd198ccd832fddc3b977fa73015535927ed7813f62453722a3e64e3cec779bda447cd2455da608ea227cd35dfc69db9bced50d9c3d826bc8db25d7657a6268084dd8c267e36cc7882df00ae583deab706c558a60509dbfeb4a098c4df466c44bd86e7d28e53480f2c855b7b6688ebd1e1d1c4ae0e61718f114c88e274833dbdb058721d37aa43ff1e0d33dd14fc4463d86f0fe7f32fb438204536f67f25cfc7d85d6eb58e5122533ee69c7eda10f95b1a5217a23c25ef57292b571d60919ee20737cafff09020301000102820201008b682fe7a6df6222834386916067c48c40f8d532d52095445df4514c6e8b57ddfc812c85494091d38762ce8e8395f8f7c79d45d93df3e9015cc48e384e9765e8027d95c9a10aad38f4603364f46c61729a885571a63b32cecf4ca61a4014194add9b646cfec5cd7b78bdcf42fe1b258719534d706bbb8959d76f0d2a7abb25bdea39f86d1eb99bac226c726576c710e6cdf3be2dacb0d0167efc8a55e90fa96bce06eff12e0bd182621a5c8452bd5cd93c10f47e5a367623c417182c2068d00e7cca386602e9338a6eaaa8ab1050d6b9cdfef8674b56eca06b94e65a38c404d881c97cd97863dd3fbd09b688d881431ec75c9d7d727242b5cfa8cdee0ee6371de50d4c4285c090baeebe8751242a6b9ee9fda9fa5a6fd93db08e52fcb92226bbd589ab5f31b01669e0c812fbae47fc1812f1619502a3cf8b3e592394f3b466293e9d355d17fef3b39afc137460f1e60746f62260a2fe2f419385e9a762cb18ad9a79d497ac9476d8c0a9fac34ea90729749ff6e0efbfe9f2976d1c6274a5e694118dfd1eb941f76f125ca85e1983bb8733dde8cca23f16fc0047f1a4b4959788764e1efdd2b292a8f54c6f11eea8bef5a262b75b9282f5528da9a7a7bf2d69cabee340238ad11d0f49333422fbded7df44d83b5a9c4d34e9b2113a7bf6a169a490afbcb48b12db4bf4920db53c376b7d7bcbd9a9859eeaaa31672bd38fb2f8250282010100f0710459cd01a206f4c4dbb8cd591c3f240c887c11bfef21d00cb0b973e4adafb373c1fec279252771e78f0cde980723f97c5457e72648e2eafaea98414eb8448be103e0e276c0a772735e9eacb45e2ac8d03562ea2c72fb1b83c101e6355aae764dff1fcd7f18ea3c8c384052e64cff91a23085d1149d9ed6c7e3bfa1e09735d6ebfeb981ed168c4942f384570c54b07c01e61afc9277a959147715ec17a29fc0a41e4c694813f755ba4f5ba21f221c0ac7d44e499e0856c66c1330b4d32f09e7b4f3bb47f6a564d381872e0d2b1b3c3dc132d31500e7fa7bde2c302a217bedba964d2dbc02d84b47cbe8bafac184963e65b028d9f6fa71b975440d0513aea30282010100d4d51ee89043051536d581b984820ba0925c006b327490ac010b27780b4612873d7c1ed1accd4e994518a51252de889410c8fefdb7fbfe05352506897a8e507eda7063ff33adda4020be19a32b26d13f35c0aa92d67cdca855561feb0e8d929481e29ce65906acc37eb514ac9b4743d8b6605ff6caa4abb1372c5b6d3c15639fc441cf5780f5dce59dc71c04e41b396bb84162b6d26f33b83ab6f63635f637d0dc36d263ba78c1bd0ba80726cda6ec09e90cd4933948ec17d43762f54c3fa8d33ed90b62204f35ba8b9354addbf227437ff5fe7f6602a3377f48a5e4db2fadd97b02ffe394a9cf2ffef2bbb1c0fa7b495306a4191aa9f4c5fea6dc9ec5c4126302820100350667943a4ed2e1bfd72e31aa2fadb80b062c8f5806c100eef5ed7f689c94e53ba91aae494b183383be3260ff31fdd9242b141ab2a251cea14da6b0df2e321b03d222ddd473a5f7079983d37078f28f72ebdfea298495f2e4d5809a1f9fc298d9044870460c727d2dcf2a949cf3a72571839839daab363b925850d4b1296b8f770f62849cafa19a5c89c4547a3200f74ed1c86249332fea8bf7a46f943a7e25c7012aa165527cfcbdce31b41ea3c90cf01fb3a5743cc2d008404b572179b554f4e18622d63301b4a3a45c207eccf3dbac2ed03b96d535539b3f9af5204574243052f7404fc73cd6154655d3ee7b00f775594da924b07ff8d69292e86027400b0282010067ce8f25c57f3ad26f0d5219873cdaa8f5d9f3c65534af7f857ec8406fd73ca043e7ef2c3b8963c5b402e2387ebcd586ca6d0e99f78bec08e433ebed501e6bba83967fdf7078625416e441a2e92024bd1cdd9d14c392e119258e3d412bb6f780819d6303a2f6737b62a8b5adbe8ad2d7b7946819fa1ab937557ec8150e522c66379615a84b591fe5cabfdbb5b300685056ed6555606c26a0bbda935a3b959d01bcf6ec45022575f15be7179de07e82f00e80588a7a4d4c020f5af864464d626dae60b481a6da9b8d2218b91b9784938c03b49aedce7688df3fb0d2613e5b12035a514b37d841beb15d3b4d3ad4b21741db4208f5c9a08da7a89e004b5c90569b02820100396271522fa813889c95111768c398ba21768328c008f9fca9868502ab1fa1bfc7c73f8ece306ec4a449a91862047d6a6bf55bdb7175e8ae5337180be4cd0ebcc6ee8ffd225b5d0a83da0f3a0256eed6232cfde243543a6601352c53c6d2028db854870169d912d7c3914aa0698fa7fadf60b713847de69e090325502a5a417c75b272d0aeb81eb19d31980a08850a30bd04d1a33093fee0fcc2a3b76e62c0834fa4633437f0a77143eba92b76590223e5f6de7488c171381593848c6b6a0d5b8a95f09c0aee821fa2bc057ba8f2751f3e9d105937c60782d1e8e7933cddf1876e697d44c93fc1e1006568e66d0d79b2cb4882d4dd618991a5a3a7b1b2c1362a'))

PEM2_DATA = bb('''-----BEGIN PRIVATE KEY-----
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
aOZtDXmyy0iC1N1hiZGlo6exssE2Kg==
-----END PRIVATE KEY-----
''')


def get_test_rsa_key():
  # Example 4096-bit key (modulus size).
  return rsakeytool.get_rsa_private_key(
      modulus=0x00c7e5c2aaa8e9e8be55a16277ab0c60d5249c0996578ae1e63261664c3b08e42ce69af7817255d0c2b3cc640b311e7d76cf1a346839905195045a040c819bd2227300130a1a7ebe78609d69c0170a1362acd57e2a605b035ae9a4904d322621079b1484640269b7a115997ced3a1fb06e7e298ad57746a7395d9b09893e7d63c48f802132cd9c530a80af0d253705dfb1212adae3a29642aeeb18c52103ec8b5a731e65af07a6b1667e385f9208c7e41ef22085f9af955b373ecc96b04b20b24a9f835ec1787b4e5471a459b7ac23a3e8e1ee8c915081a1ee4a55a13c2b077f6c58aa7db1e4badcf670c24ff14c179146e573eb99db77bdf3a83bce808185b194953d5ccc78be03ec7665c6bab34a7fe45bfb306efa8d1e5e9dc2403ef66a1da2cae70b7026c5223782ae28252eac0103715e2e4341b9040d46f886bd198ccd832fddc3b977fa73015535927ed7813f62453722a3e64e3cec779bda447cd2455da608ea227cd35dfc69db9bced50d9c3d826bc8db25d7657a6268084dd8c267e36cc7882df00ae583deab706c558a60509dbfeb4a098c4df466c44bd86e7d28e53480f2c855b7b6688ebd1e1d1c4ae0e61718f114c88e274833dbdb058721d37aa43ff1e0d33dd14fc4463d86f0fe7f32fb438204536f67f25cfc7d85d6eb58e5122533ee69c7eda10f95b1a5217a23c25ef57292b571d60919ee20737cafff09,
      public_exponent=0x10001,
      prime1=0x00f0710459cd01a206f4c4dbb8cd591c3f240c887c11bfef21d00cb0b973e4adafb373c1fec279252771e78f0cde980723f97c5457e72648e2eafaea98414eb8448be103e0e276c0a772735e9eacb45e2ac8d03562ea2c72fb1b83c101e6355aae764dff1fcd7f18ea3c8c384052e64cff91a23085d1149d9ed6c7e3bfa1e09735d6ebfeb981ed168c4942f384570c54b07c01e61afc9277a959147715ec17a29fc0a41e4c694813f755ba4f5ba21f221c0ac7d44e499e0856c66c1330b4d32f09e7b4f3bb47f6a564d381872e0d2b1b3c3dc132d31500e7fa7bde2c302a217bedba964d2dbc02d84b47cbe8bafac184963e65b028d9f6fa71b975440d0513aea3)


class RsakeytoolTest(unittest.TestCase):
  maxDiff = None

  def test_parse_repr_bytes(self):
    f = rsakeytool.parse_repr_bytes
    self.assertEqual(bb(''), f(bb("b''")))
    self.assertEqual(bb('hello'), f(bb("B'hello'")))
    self.assertRaises(ValueError, f, bb("b'hello"))
    self.assertRaises(ValueError, f, bb("''"))
    self.assertRaises(ValueError, f, bb(""))
    self.assertRaises(ValueError, f, bb("b'he\nlo'"))
    self.assertRaises(ValueError, f, bb("b'he\'lo'"))
    self.assertRaises(ValueError, f, bb("b'\\w'"))
    self.assertEqual(bb('h\'"e\\l\'lo'), f(bb("B'h\\'\"e\\\\l\\'lo'")))
    self.assertEqual(bb('\a\b\v\f\n\r\t\v'), f(bb("b'\\a\\b\\v\\f\\n\\r\\t\\v'")))
    self.assertEqual(binascii.unhexlify(bb('284a4a2c7eff29')), f(bb('b"(\\x4A\\X4a,\\176\\377)"')))
    self.assertRaises(ValueError, f, bb("b'\\x1G'"))
    self.assertRaises(ValueError, f, bb("b'\\308'"))
    self.assertRaises(ValueError, f, bb("b'\\400'"))

  def test_convert(self):
    d = get_test_rsa_key()
    assert rsakeytool.is_rsa_private_key_complete(d)
    convert_rsa_data = rsakeytool.convert_rsa_data
    der = convert_rsa_data(d, 'der')
    pem = convert_rsa_data(d, 'pem')
    der2 = convert_rsa_data(d, 'der2')
    pem2 = convert_rsa_data(d, 'pem2')
    assert convert_rsa_data(der, 'der') == der
    assert convert_rsa_data(pem, 'der') == der
    assert convert_rsa_data(der2, 'der') == der
    assert convert_rsa_data(pem2, 'der') == der
    assert convert_rsa_data(der, 'dict') == d
    assert convert_rsa_data(convert_rsa_data(der, 'dropbear'), 'der') == der
    assert convert_rsa_data(convert_rsa_data(der, 'msblob'), 'der') == der
    d = {'public_exponent': 5, 'prime1': 23, 'prime2': 29}
    dd = {'public_exponent': 5, 'private_exponent': 493, 'prime1': 29, 'prime2': 23, 'modulus': 667, 'exponent1': 17, 'exponent2': 9, 'coefficient': 24}
    self.assertEqual(dd, convert_rsa_data(d, 'dict'))
    self.assertEqual(dd, convert_rsa_data(dd, 'dict'))
    self.assertEqual(dd, convert_rsa_data({'e': 5, 'd': 493, 'n': 0x29B}, 'dict'))
    dd2 = dict(dd, private_exponent=dd['private_exponent'] - 308)
    d2 = dict(d, private_exponent=dd2['private_exponent'])
    self.assertEqual(dd2, convert_rsa_data(d2, 'dict'))
    self.assertEqual(dd2, convert_rsa_data(dd2, 'dict'))
    dd['comment'] = bb('mycomment')
    dd['checkint'] = 1234
    self.assertEqual(bb('modulus = 0x029b\npublic_exponent = 0x05\nprivate_exponent = 0x01ed\nprime1 = 0x1d\nprime2 = 0x17\nexponent1 = 0x11\nexponent2 = 0x09\ncoefficient = 0x18\ncomment = b\'mycomment\'\ncheckint = 0x04d2\n'),
                     convert_rsa_data(dd, 'hexa'))
    hexa_data = bb('n  = 0x29b\npublic_exponent   =5\nprivate_exponent\t\r=\n0x1Ed\nprime1 = 0x1d\nprime2 = 23\nexponent1 = 0x11\nexponent2 = 0x9  \t\ncomment = B"mycomment"  \ncoefficient = 0X18\ncheckint = 1234')
    self.assertEqual(dd, convert_rsa_data(bb(' \t\r\n  ') + hexa_data, 'dict'))
    self.assertEqual(dd, convert_rsa_data(hexa_data, 'dict'))

  def test_golden(self):
    d = get_test_rsa_key()
    convert_rsa_data = rsakeytool.convert_rsa_data
    assert convert_rsa_data(d, 'dropbear') == DROPBEAR_DATA
    assert convert_rsa_data(DROPBEAR_DATA, 'dict') == d
    assert convert_rsa_data(d, 'opensshsingle') == OPENSSHSINGLE_DATA
    assert convert_rsa_data(OPENSSHSINGLE_DATA, 'dict') == d
    assert convert_rsa_data(d, 'opensshld') == OPENSSHLD_DATA
    assert convert_rsa_data(OPENSSHLD_DATA, 'dict') == dict(d, checkint=0x43484B49)
    assert convert_rsa_data(d, 'opensshbin') == OPENSSHBIN_DATA
    assert convert_rsa_data(OPENSSHBIN_DATA, 'dict') == dict(d, checkint=0x43484B49)
    assert convert_rsa_data(d, 'openssh') == OPENSSH_DATA
    assert convert_rsa_data(OPENSSH_DATA, 'dict') == dict(d, checkint=0x43484B49)
    assert convert_rsa_data(d, 'msblob') == MSBLOB_DATA
    assert convert_rsa_data(MSBLOB_DATA, 'dict') == d
    assert convert_rsa_data(d, 'gpg22') == GPG22_DATA
    assert convert_rsa_data(GPG22_DATA, 'dict') == d
    assert convert_rsa_data(d, 'gpg23') == GPG23_DATA
    assert convert_rsa_data(GPG23_DATA, 'dict') == d
    assert convert_rsa_data(bb('Description: foo\n  bar\n') + GPG23_DATA + bb('Token: foo\n'), 'dict') == d
    #assert convert_rsa_data(d, 'gpglist') == GPGLIST_DATA  # Serialization of format='gpglist' is not implemented.
    assert convert_rsa_data(GPGLIST_DATA, 'dict', keyid='318562D809aD3F15') == d
    assert convert_rsa_data(d, 'der2') == DER2_DATA
    assert convert_rsa_data(DER2_DATA, 'dict') == d
    assert convert_rsa_data(d, 'pem2') == PEM2_DATA
    assert convert_rsa_data(PEM2_DATA, 'dict') == d

  def test_build_gpg_export_secret_key_data(self):
    d = {  # key_id20: A2D68183CB4D58902218916F901BF337B182BAE5
        'modulus': 0xb54dd426fb9641c9f7caa294bb7da157d83d376c7eadc44e937f8870654355067029730c02e28a9d4752a5c6069717a03d8b4b1f7199da1da29d542c42361ca0f3720aa78c659fbf55f7d9d18dce8052c2da1b610506451faaf565258df9c8f783a422826ad6d28e1f98bd3a4f08120eea8be67aaffb91580c103008683403c5,
        'public_exponent': 0x010001,
        'private_exponent': 0x92fa6237ac1376880dea66fcde360d7b5260e6327d4bcf6dc7e346af9f580370b1b2d8826f404a1110c5ee7fe7cdcb286b5c25ed7ac1b7f1f86744da905e9fbb795fcc7cbc47af9eeac4f555820472e1e9eb4e17c017a1462fbd3efac7e78b2813593a9f1f546b418849930d4f968ddc4455d3767e5e45638a0b16bccb6be6ad,
        'prime1': 0xe41b738589bf944e9d72961ed9e6be7b4854b501d2f00aadad3dafda01f5b7d40d6fd179fb647b1987899678e4ca4f3e3b0cc54f9c6d2ecb8c07b66bf4c3df0b,
        'prime2': 0xcb7946393798bdcc2c5c9d8baf9cbd33255d06a4aad5eb5b1f630dd316029dc59ea9dbb3a5268dd63a533d4ac1e01059927e6c16c6eb71ef61eb658d6d1baa6f,
        'exponent1': 0x7a3412b189d86ef5a6f80a60c0d013602ca1e4cef358d1ffb57e04c5c0a30936bb741a3f4564d1661deca206665bd4143cc25cba87cd1e72c1b42810b1f2757d,
        'exponent2': 0x1ade42c59f6fcdf03e1364c26348213bb5bd58f9398dd1ec5072b60a9fa76cca01af905162877ac7452064c1906454045ff1cdb81c404ee53b5ae8280ab65285,
        'coefficient': 0xa0530e72144d8de540059c209f6c64975b55ca81f539a23daa17cbbc724345e6c9168a637cd33e006110a97d8a2c3812dfb069431d14a301b6fc5866fa8b7743,
        'comment': bb('Test Real Name 5 (Comment 5) <testemail5@email.com>'),
        'creation_time': 0x55f12345,  # Unix timestamp.
    }
    d_sub = {  # key_id20: 49354F5DC6B4F10334719ACB1407522D74034ED7
        'modulus': 0xd18278c2c44e8473eceeacc3f423118b88d7d11e1a083a7de7cc5303b71b77822b7c1b337be22094534569a9e0f6e0fbc2a2246b05b89884522b759f1fb500e5183ff766b943825168e5f5c8d86e322d74b939cbbd13f4abc98d61d4c535b217c345d7336618baf13eadaae3fb25d7cf87cac4b47d7fe522bed3158204ed6add,
        'public_exponent': 0x010001,
        'private_exponent': 0xaa9d2fae9ca2bc66935a42c348fb8dfc2db2630fba6f5d02cf53ab7ee90cab240c398305482b7c108e4786a6db16f15cd4c1aa1aa58c1058217a56cd00cb2c2fea57c0974aa41ba72d4ce722bfdb2838b941045c8ebec08d5983fbdbc14fec3b89856ac90c6bc92306cd10841cb8f49722bc4bd591d9b10753a80e649cff4bd9,
        'prime1': 0xfa6bf942f51480cf9fae0f0077bc799091a93d5eb5a8f827ccd7a951ebf3bbcc4ac893924d17e99c99bf9c1466bd26815af0978df5908f82ac18c3ff67d63d9b,
        'prime2': 0xd62d3283c2fa4c5e24560d2d5cdb78a503dd10eb60dec0dd0107b30b4cb4cc1d7d9b8c90d24bb9a18b97e23225611dfaa1256f13b8479479f48cc73cbcfabce7,
        'exponent1': 0x85860ce226cb47e36cc0e23edd992138747248c6b715e13b577da64a8804ed9d8042726d0fae3061cf98db2005a7d560239d25320c3d8847a47b90061ed79d01,
        'exponent2': 0x6e93af3ceff1a2740876951f128e0d5fc4fae1bd64aa1d10fd732831714cf70552d078665cecd3ce5fefeecccd17b30eaf1c5098f1cfa30cc401daebb4f60f89,
        'coefficient': 0x250d073534473d0bbb5afe7554e822a8b8e655512718e404523484ae679aa047d03eaf571e87bdb72b98de1000add01d4378beed12b4ede9601dd9bfaf6370dc,
        'creation_time': 0x55f12346,
    }
    gpg_export_secret_key_data0 = binascii.unhexlify('9501d80455f12345010400b54dd426fb9641c9f7caa294bb7da157d83d376c7eadc44e937f8870654355067029730c02e28a9d4752a5c6069717a03d8b4b1f7199da1da29d542c42361ca0f3720aa78c659fbf55f7d9d18dce8052c2da1b610506451faaf565258df9c8f783a422826ad6d28e1f98bd3a4f08120eea8be67aaffb91580c103008683403c5001101000100040092fa6237ac1376880dea66fcde360d7b5260e6327d4bcf6dc7e346af9f580370b1b2d8826f404a1110c5ee7fe7cdcb286b5c25ed7ac1b7f1f86744da905e9fbb795fcc7cbc47af9eeac4f555820472e1e9eb4e17c017a1462fbd3efac7e78b2813593a9f1f546b418849930d4f968ddc4455d3767e5e45638a0b16bccb6be6ad0200cb7946393798bdcc2c5c9d8baf9cbd33255d06a4aad5eb5b1f630dd316029dc59ea9dbb3a5268dd63a533d4ac1e01059927e6c16c6eb71ef61eb658d6d1baa6f0200e41b738589bf944e9d72961ed9e6be7b4854b501d2f00aadad3dafda01f5b7d40d6fd179fb647b1987899678e4ca4f3e3b0cc54f9c6d2ecb8c07b66bf4c3df0b0200a0530e72144d8de540059c209f6c64975b55ca81f539a23daa17cbbc724345e6c9168a637cd33e006110a97d8a2c3812dfb069431d14a301b6fc5866fa8b77439e60b43354657374205265616c204e616d6520352028436f6d6d656e74203529203c74657374656d61696c3540656d61696c2e636f6d3e88ce041301080038162104a2d68183cb4d58902218916f901bf337b182bae5050255f12345021b03050b09080702061508090a0b020416020301021e01021780000a0910901bf337b182bae58e7a03ff5628b1f3115c49f588c4823790bb9317cb3e9909ccf722fe2d3f4d602ccda26fe7793bbf61bc4056fb4939df1b1cd448233b335e13388f055f9128afce539b13437836b458f4626a52c0d7ffe2637ef0b46528c6ce54eb13a915e07e74c0f1e208bbb3905751f7e82c96be54a89af4d4d739af43a801ed64e332ed724e8f65e49d01d80455f12346010400d18278c2c44e8473eceeacc3f423118b88d7d11e1a083a7de7cc5303b71b77822b7c1b337be22094534569a9e0f6e0fbc2a2246b05b89884522b759f1fb500e5183ff766b943825168e5f5c8d86e322d74b939cbbd13f4abc98d61d4c535b217c345d7336618baf13eadaae3fb25d7cf87cac4b47d7fe522bed3158204ed6add0011010001000400aa9d2fae9ca2bc66935a42c348fb8dfc2db2630fba6f5d02cf53ab7ee90cab240c398305482b7c108e4786a6db16f15cd4c1aa1aa58c1058217a56cd00cb2c2fea57c0974aa41ba72d4ce722bfdb2838b941045c8ebec08d5983fbdbc14fec3b89856ac90c6bc92306cd10841cb8f49722bc4bd591d9b10753a80e649cff4bd90200d62d3283c2fa4c5e24560d2d5cdb78a503dd10eb60dec0dd0107b30b4cb4cc1d7d9b8c90d24bb9a18b97e23225611dfaa1256f13b8479479f48cc73cbcfabce70200fa6bf942f51480cf9fae0f0077bc799091a93d5eb5a8f827ccd7a951ebf3bbcc4ac893924d17e99c99bf9c1466bd26815af0978df5908f82ac18c3ff67d63d9b01fe250d073534473d0bbb5afe7554e822a8b8e655512718e404523484ae679aa047d03eaf571e87bdb72b98de1000add01d4378beed12b4ede9601dd9bfaf6370dca0cc88b6041801080020162104a2d68183cb4d58902218916f901bf337b182bae5050255f12346021b0c000a0910901bf337b182bae580d903fd147177cd2346d58d8b670927126fee685eae957c31db1036eb8757853561ab3635afd2642022672f5ab7e5ce7102fae7087fef059e8f12496a142394694c95fbfe84956fcb6f51ceffd8e895e142b7d0206691bf1df88223aef466df0040b4d0015185697ac77f820e12bbe57681f86716648bd2d98580238bab1ce853d00454')
    self.assertEqual(gpg_export_secret_key_data0, rsakeytool.build_gpg_export_secret_key_data(d, d_sub))
    gpg_export_secret_key_data1 = binascii.unhexlify('9501d80455f12345010400b54dd426fb9641c9f7caa294bb7da157d83d376c7eadc44e937f8870654355067029730c02e28a9d4752a5c6069717a03d8b4b1f7199da1da29d542c42361ca0f3720aa78c659fbf55f7d9d18dce8052c2da1b610506451faaf565258df9c8f783a422826ad6d28e1f98bd3a4f08120eea8be67aaffb91580c103008683403c5001101000100040092fa6237ac1376880dea66fcde360d7b5260e6327d4bcf6dc7e346af9f580370b1b2d8826f404a1110c5ee7fe7cdcb286b5c25ed7ac1b7f1f86744da905e9fbb795fcc7cbc47af9eeac4f555820472e1e9eb4e17c017a1462fbd3efac7e78b2813593a9f1f546b418849930d4f968ddc4455d3767e5e45638a0b16bccb6be6ad0200cb7946393798bdcc2c5c9d8baf9cbd33255d06a4aad5eb5b1f630dd316029dc59ea9dbb3a5268dd63a533d4ac1e01059927e6c16c6eb71ef61eb658d6d1baa6f0200e41b738589bf944e9d72961ed9e6be7b4854b501d2f00aadad3dafda01f5b7d40d6fd179fb647b1987899678e4ca4f3e3b0cc54f9c6d2ecb8c07b66bf4c3df0b0200a0530e72144d8de540059c209f6c64975b55ca81f539a23daa17cbbc724345e6c9168a637cd33e006110a97d8a2c3812dfb069431d14a301b6fc5866fa8b77439e60b43354657374205265616c204e616d6520352028436f6d6d656e74203529203c74657374656d61696c3540656d61696c2e636f6d3e88ce041301080038162104a2d68183cb4d58902218916f901bf337b182bae5050255f12345021b0f050b09080702061508090a0b020416020301021e01021780000a0910901bf337b182bae51ee303ff6d468141a7a02fe06184c8fbd8eb3e040d11adb72ade4f6123a11513c7dbeb336b69779285fc088586a869978c26506c0934d64df265d7d426f8b3849d73bab073eb8293e76703332e3fbbf314e14adc1ef2f8322858cb68306bb317d1b5160861acf922db7e50c313e5e2e22234ea4f93b53b9356611d7d24fa803b65d85546')
    self.assertEqual(gpg_export_secret_key_data1, rsakeytool.build_gpg_export_secret_key_data(d, d_sub=None))
    # open('key5.bin', 'wb').write(rsakeytool.build_gpg_export_secret_key_data(d, d_sub))
    # $ gpg --import <key5.bin
    # ...
    # $ (echo 5; echo y; echo save) | gpg --expert --command-fd 0 --yes --no-tty --no-greeting --quiet --edit-key "$(gpg --list-packets <key5.bin | awk '$1=="keyid:"{print$2;exit}')" trust  # Ultimate trust.
    # #$ #(echo 1; echo y; echo save) | gpg --expert --command-fd 0 --yes --no-tty --no-greeting --quiet --edit-key "$(gpg --list-packets <key5.bin | awk '$1=="keyid:"{print$2;exit}')" trust  # Unknown trust.
    # $ echo hello | gpg -e -r testemail5 >hello.bin
    # $ gpg -d -q <hello.bin
    # hello


if __name__ == '__main__':
  unittest.main(argv=[sys.argv[0], '-v'] + sys.argv[1:])
